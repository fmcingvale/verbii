
\ Unittests for random-mersenne module
\
\ Copyright (c) 2022 Frank McIngvale, see LICENSE

"unittest" import
"random-mersenne" import

\ unittest-init

: test-mersenne-twister
	\ this is a list of:
	\	[ seed skip [ expect0 ... ] ]

	\ test values were generated by reference/mersenne_twister_stdlib.cpp
	[
		[ 3546416464 2308 [ 1776279582 381871765 55904378 236026755 1365034181 4152869323 3462537977 1570395861 4243311499 2875303496 ] ]
		[ 3994902905 2308 [ 760324371 1785303026 2658231597 3045280103 2858633554 3868106082 3464779155 157266909 572154977 1355025530 ] ]
		[ 4109379183 2308 [ 1733744886 940870647 273884066 3738843582 30186894 2426466110 4235445094 878910184 882109126 706552482 ] ]
		[ 4215500625 2308 [ 3261760948 3188707330 3861210396 2790928619 957735764 2489449590 2713238053 1647536910 3333617583 2743762793 ] ]
		[ 908173132 2308 [ 3414088778 935425508 1441170774 3805015074 1708230973 3914393856 2485104423 3664976330 2659085511 4249820528 ] ]
	]
	{ ( P )
		@locals [ seed skip vals ]
		\ just to make code more readable
		P 0 get seed!
		P 1 get skip!
		P 2 get vals!
		
		"SEED:" . seed . CR
		"SKIP:" . skip . CR
		"VALS:" . vals . CR
		
		seed mersenne-random-seed 
		\ skip first 'skip' numbers
		{ mersenne-random-extract drop } skip repeat
		\ now next #vals generated numbers must match vals
		{ ( i )
			vals i get 
			mersenne-random-extract expect==
			} 0 1 vals length for-range
		} for-each
	;
	
\ unittest-summary
